from library.excel_report.constants import MONTHWISE_DETAILS_DICT_V5

debit_tags = {'international_transaction_arbitrage', 'bill_payment', 'cash_withdrawl', 'bank_charge', 'debit_card',
              'outward_cheque_bounce', 'chq', 'upi', 'auto_debit_payment', 'net_banking_transfer',
              'payment_gateway_purchase', "investment", "self_transfer"}


credit_tags = {'international_transaction_arbitrage', 'bank_interest', 'refund', 'cash_deposit', 'upi',
               'net_banking_transfer', 'auto_debit_payment_bounce', 'chq', 'investment_cashin', 'inward_cheque_bounce', "self_transfer"}

def get_monthly_analysis_mapping(version='v1'): 
    if version=='v5':
        return MONTHWISE_DETAILS_DICT_V5
    
    mapping = {
        "Total No. of Credit Transactions": "cnt_credit",
        "Total Amount of Credit Transactions": "amt_credit",
        "Total No. of Debit Transactions": "cnt_debit",
        "Total Amount of Debit Transactions": "amt_debit",
        "Total No. of Cash Deposits": "cnt_cash_deposit_credit",
        "Total Amount of Cash Deposits": "amt_cash_deposit_credit",
        "Total No. of Cash Withdrawals": "cnt_cash_withdrawl_debit",
        "Total Amount of Cash Withdrawals": "amt_cash_withdrawl_debit",
        "Total No. of Cheque Deposits": "cnt_chq_credit",
        "Total Amount of Cheque Deposits": "amt_chq_credit",
        "Total No. of Cheque Issues": "cnt_chq_debit",
        "Total Amount of Cheque Issues": "amt_chq_debit",
        "Total No. of Inward Cheque Bounces": "cnt_inward_cheque_bounce_credit",
        "Total No. of Outward Cheque Bounces": "cnt_outward_cheque_bounce_debit",
        "Min EOD Balance": "min_eod_balance",
        "Max EOD Balance": "max_eod_balance",
        "Average EOD Balance": "",
        "Opening Balance": "opening_balance",
        "Closing balance": "closing_balance",
        "Net Cashflow": "",
        "Median Balance": "median_balance",
        "Average Credit Transaction Size": "avg_credit_transaction_size",
        "Average Debit Transaction Size": "avg_debit_transaction_size",
        "Average EMI Transactions Size": "",
        "Mode Balance": "mode_balance",
        "Number of Transactions": "cnt_transactions",
        "Maximum Balance": "max_bal",
        "Minimum Balance": "min_bal",
        "Total Amount Credited through transfers": "amt_net_banking_transfer_credit",
        "Total Amount Credited through UPI": "amt_upi_credit",
        "Total Amount of Salary": "total_amount_of_salary",
        "Total Amount of International Credit": "amt_international_transaction_arbitrage_credit",
        "Total Amount of Investment Cash-ins": "amt_investment_cashin_credit",
        "Total Amount of Refund": "amt_refund_credit",
        "Total Amount of Bank Interest": "amt_bank_interest_credit",
        "Total Amount Spend through Debit card": "amt_debit_card_debit",
        "Total Amount of Auto-Debit Payments": "amt_auto_debit_payment_debit",
        "Total Amount of Bill Payments": "amt_bill_payment_debit",
        "Total Amount of Bank Charges": "amt_bank_charge_debit",
        "Total Amount of Auto debit bounce": "amt_auto_debit_payment_bounce_credit",
        "Total Amount Debited through UPI": "amt_upi_debit",
        "Total Amount Debited through transfers": "amt_net_banking_transfer_debit",
        "Total Amount of International Debit": "amt_international_transaction_arbitrage_debit",
        "Total Amount Debited through Outward Cheque Bounce": "amt_outward_cheque_bounce_debit",
        "Total Amount Credited through Inward Cheque Bounce": "amt_inward_cheque_bounce_credit",
        "Total Amount Debited through Ach Bounce Charge": "amt_ach_bounce_charge",
        "Total Amount Debited through Cheque Bounce Charge": "amt_chq_bounce_charge",
        "Total Amount Debited through Bounce Charge": "amt_bounce_charge",
        "Total Amount of Payment Gateway Purchase": "amt_payment_gateway_purchase_debit",
        "Total Amount Debited through EMI": "amt_emi_debit",
        "Total Amount Credit Card Bill Debit": "amt_credit_card_bill_debit",
        "Total Amount of investments": "amt_investment",
        "Total Loan Credits Amount": "amt_loan_credits",
        "Total Debit without OW and Refund": "",
        "Total Credit without IW and Refund": "",
        "Turnover Excluding Loan and Self Credits": "",
        "Turnover Excluding self credits,lender transactions and FD/RD": "turnover_excluding_loan_self_and_fdrd_credit",
        "Total Amount of Credit Self-transfer": "amt_self_transfer_credit",
        "Total Amount of Debit Self-transfer": "amt_self_transfer_debit",
        "Total Amount of Business Credit": "amt_business_credit",
        "Total No. of Business Credit": "cnt_business_credit",
        "Number of Loan Credits": "cnt_loan_credits",
        "Number of investments": "cnt_investment",
        "Number of Credit Card Bill Debit": "cnt_credit_card_bill_debit",
        "Number of EMI Transactions": "cnt_emi_debit",
        "Number of Cash Deposit Transactions": "cnt_cash_deposit_credit",
        "Number of Net Banking Credit Transactions": "cnt_net_banking_transfer_credit",
        "Number of Credit Transactions through UPI": "cnt_upi_credit",
        "Number of Salary Transactions": "number_of_salary_transactions",
        "Number of International Credit transactions": "cnt_international_transaction_arbitrage_credit",
        "Number of Investment Cash-ins": "cnt_investment_cashin_credit",
        "Number of Refund Transactions": "cnt_refund_credit",
        "Number of Bank Interest Credits": "cnt_bank_interest_credit",
        "Number of Debit Card Transactions": "cnt_debit_card_debit",
        "Number of Auto-debited payments": "cnt_auto_debit_payment_debit",
        "Number of Bill Payments": "cnt_bill_payment_debit",
        "Number of Bank Charge payments": "cnt_bank_charge_debit",
        "Number of Debit Transactions through Ach Bounce Charge": "cnt_ach_bounce_charge",
        "Number of Debit Transactions through Cheque Bounce Charge": "cnt_chq_bounce_charge",
        "Number of Debit Transactions through Bounce Charge": "cnt_bounce_charge",
        "Number of Auto-Debit Bounces": "cnt_auto_debit_payment_bounce_credit",
        "Number of Debit Transactions through UPI": "cnt_upi_debit",
        "Number of Net Banking Debit Transactions": "cnt_net_banking_transfer_debit",
        "Number of International Debit transactions": "cnt_international_transaction_arbitrage_debit",
        "Number of Payment Gateway Purchase": "cnt_payment_gateway_purchase_debit",
        "Number of Self-transfer Credit": "cnt_self_transfer_credit",
        "Number of Self-transfer Debit": "cnt_self_transfer_debit",
        "% Salary Spent on Bill Payment (7 days)": "perc_salary_spend_bill_payment",
        "% Salary Spent Through Cash Withdrawal (7 days)": "perc_salary_spend_cash_withdrawl",
        "% Salary Spent through Debit Card (7 days)": "perc_salary_spend_debit_card",
        "% Salary Spent through Net Banking (7 days)": "perc_salary_spend_net_banking_transfer",
        "% Salary Spent through UPI (7 days)": "perc_salary_spend_upi",
        "Total Amount Credited through Investment": "amt_investment_credit",
        "Total Amount Credited through Dividend": "amt_dividend_credit",
        "Total Amount of Rent Credited": "amt_rent_credit",
        "Total Amount Spent on Fuel": "amt_fuel_related_debits",
        "Total Amount Spent on Entertainment": "amt_spent_on_entertainment",
        "Total Amount Spent on Food": "amt_food_related_debits",
        "Total Amount Spent on Medical": "amt_spent_on_medical",
        "Total Amount Spent on Shopping": "amt_shopping_related_debits",
        "Total Amount Spent on Travel": "amt_travel_related_debits",
        "Total Amount Spent on Groceries": "amt_spent_on_groceries",
        "Total Amount of Netting Credits": "amt_netting_credits",
        "Total number of Netting Credits": "cnt_netting_credits",
        "Total Amount of Netting Debits": "amt_netting_debits",
        "Total number of Netting Debits": "cnt_netting_debits"
    }
    if version=='v3':
        mapping.update(
            {
                "% Inward Bounce": "perc_inward_bounce",
                "% Outward Bounce": "perc_outward_bounce",
                "% Cash Deposit to Total Credit": "perc_cash_deposit_to_total_credit",
                "Net Credit Amount": "net_credit_amount",
                "Net Debit Amount": "net_debit_amount",
                "Net Debit Count": "net_debit_count",
                "Net Credit Count": "net_credit_count",
                "Number of Days with balance < 25000": "cnt_days_eod_bal_lt_25000",
                "Interest on CC/OD": "amt_ccod_interest"
            }
        )
    return mapping

def monthwise_details_dict():
    return [
        ["EOD Balance on 1","eod_bal_on_01"],
        ["EOD Balance on 6","eod_bal_on_06"],
        ["EOD Balance on 11","eod_bal_on_11"],
        ["EOD Balance on 16","eod_bal_on_16"],
        ["EOD Balance on 21","eod_bal_on_21"],
        ["Total","sum_of_eod_bal_on_1_6_11_16_21"],
        ["Monthly Average","avg_of_eod_bal_on_1_6_11_16_21"],
        ["Average Bank Balances",""],
        ["EOD Balance on 1","eod_bal_on_01"],
        ["EOD Balance on 10","eod_bal_on_10"],
        ["EOD Balance on 15","eod_bal_on_15"],
        ["EOD Balance on 25","eod_bal_on_25"],
        ["Totals","sum_of_eod_bal_on_1_10_15_25"],
        ["Averages","avg_of_eod_bal_on_1_10_15_25"],
        ["EOD Balance as on 1st of Month","eod_bal_on_01"],
        ["EOD Balance as on 5th of Month","eod_bal_on_05"],
        ["EOD Balance as on 15th of Month","eod_bal_on_15"],
        ["EOD Balance as on 25th of Month","eod_bal_on_25"],
        ["Total","sum_of_eod_bal_on_1_5_15_25"],
        ["Average","avg_of_eod_bal_on_1_5_15_25"],
        ["Credits","cnt_credit_excluding_reversal"],
        ["Debits","cnt_debit_excluding_reversal"],
        ["IW IRT Count","cnt_emi_bounce_non_tech_reason_credit"],
        ["OW IRT Count","cnt_outward_cheque_bounce_debit"],
        ["Total","sum_of_cnt_credit_debit_excluding_reversal_and_cnt_iw_bounce_non_tech_ow_bounce"],
        ["Credit Total","amt_credit_excluding_reversal"],
        ["Total Credits","amt_credit_excluding_reversal"],
        ["total turnover","total_turnover"],
        ["% of top line","perc_top_line"],
        ["IW RTN","perc_non_tech_inward_bounce_transactions_to_debits_excluding_reversal"],
        ["OW RTN","perc_outward_bounce_transactions_to_debits_excluding_reversal"]
    ]